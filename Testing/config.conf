# =================================================================
# SOC INCIDENT RESPONSE CONFIGURATION - NIST 800-61r2 FRAMEWORK
# =================================================================
# File konfigurasi terpusat untuk semua script IRLC
# Sesuai dengan NIST 800-61r2: Preparation, Detection & Analysis, 
# Containment, Eradication, Recovery, dan Post-Incident Activity

# =================================================================
# PREPARATION PHASE - Konfigurasi Dasar Sistem
# =================================================================

# Direktori web yang akan diproteksi
WEB_DIR="/var/www/html"

# Direktori backup utama
BACKUP_DIR="/var/soc-backup"

# Direktori karantina untuk file mencurigakan
QUARANTINE_DIR="/var/soc-quarantine"

# Direktori log untuk semua aktivitas IRLC
LOG_DIR="/var/log/soc-incident-response"

# Direktori konfigurasi SOC
SOC_CONFIG_DIR="/etc/soc-config"

# =================================================================
# DETECTION & ANALYSIS PHASE - Wazuh Integration
# =================================================================

# File alerts.json utama Wazuh
WAZUH_ALERTS_FILE="/var/ossec/logs/alerts/alerts.json"

# Direktori log Wazuh active response
WAZUH_ACTIVE_RESPONSE_LOG_DIR="/var/log/wazuh/active-response"

# Rule IDs untuk deteksi defacement
DEFACE_RULE_IDS="550,554,5501,5502,5503,5504,100001,100002"

# Rule IDs untuk deteksi serangan
ATTACK_RULE_IDS="5710,5712,5715,5760,100003,100004"

# Rule IDs untuk trigger eradication
ERADICATION_RULE_IDS="5710,5712,5715,5760,100003,100004"

# Rule IDs untuk trigger auto restore
RESTORE_RULE_IDS="100010,100011,100012"

# =================================================================
# CONTAINMENT PHASE - Network & System Isolation
# =================================================================

# File untuk mencatat IP yang diblokir
BLOCKED_IPS_FILE="/var/log/soc-incident-response/blocked_ips.txt"

# File halaman maintenance
MAINTENANCE_PAGE_FILENAME="maintenance.html"

# File index utama
INDEX_FILENAME="index.html"

# =================================================================
# ERADICATION PHASE - Threat Removal
# =================================================================

# Direktori YARA rules
YARA_RULES_DIR="/var/ossec/etc/rules/yara"

# Socket path ClamAV daemon
CLAMD_SOCKET="/var/run/clamav/clamd.ctl"

# Pattern mencurigakan untuk deteksi (pisahkan dengan |||)
ERADICATION_SUSPICIOUS_PATTERNS="(?i)(eval\s*\(base64_decode\s*\()|||(?i)(passthru\s*\()|||(?i)(shell_exec\s*\()|||(?i)(system\s*\()|||(?i)(exec\s*\()|||(?i)(preg_replace\s*\(.*\/e\s*\))|||(?i)(FilesMan|phpfm|P\.A\.S\.|\bWebShell\b|r57shell|c99shell)|||(?i)(document\.write\s*\(\s*unescape\s*\()|||(?i)(<iframe\s*src\s*=\s*[\"']javascript:)|||(?i)(fsockopen|pfsockopen)\s*\("

# =================================================================
# RECOVERY PHASE - System Restoration
# =================================================================

# Password untuk restore (base64 encoded)
PASSWORD="c29jLXJlc3RvcmUtcGFzc3dvcmQ="

# Konfigurasi monitoring server
MONITOR_IP="192.168.1.100"
MONITOR_USER="soc-backup"
MONITORING_SERVER="192.168.1.100"
MONITORING_USER="soc-backup"
MONITORING_PASSWORD=""

# Path backup remote
REMOTE_GIT_BACKUP_PATH="/home/soc-backup/git-backup"
REMOTE_BACKUP_PATH="/home/soc-backup/backups"
REMOTE_DYNAMIC_BACKUP_PATH="/home/soc-backup/dynamic-backup"

# File identitas SSH
SSH_IDENTITY_FILE="/home/soc-backup/.ssh/id_rsa"

# Cache direktori untuk restore dinamis
LOCAL_DYNAMIC_RESTORE_CACHE_DIR="/tmp/soc-dynamic-restore-cache"

# Backup dinamis aktif (true/false)
BACKUP_DYNAMIC="true"

# Direktori dinamis yang akan di-backup (array bash format)
DYNAMIC_DIRS=("uploads" "cache" "temp" "logs")

# User dan group web server
WEB_SERVER_USER="www-data"
WEB_SERVER_GROUP="www-data"

# =================================================================
# POST-INCIDENT ACTIVITY - Documentation & Analysis
# =================================================================

# Konfigurasi MISP untuk threat intelligence
MISP_URL="https://192.168.28.135"
MISP_KEY="XweOnEWOtWFmIbW585H2m03R3SIZRmIKxrza73WB"
MISP_VERIFY_CERT="false"

# Direktori untuk laporan insiden
INCIDENT_REPORTS_DIR="/var/log/soc-incident-response/reports"

# File audit log
AUDIT_LOG="/var/log/soc-incident-response/audit.log"

# File log untuk MISP integration
MISP_LOG_FILE="/var/log/soc-incident-response/misp.log"

# =================================================================
# OUTPUT FILES - File Output untuk Setiap Fase
# =================================================================

# File output untuk deteksi IoC
DETECTION_OUTPUT_FILE="/tmp/active_response_500550.log"
DETECTION_LOG_FILE="/tmp/find_last_500550_debug.log"
IOC_DATA_FILE="/tmp/detected_ioc_data.json"

# File output untuk containment
CONTAINMENT_LOG_FILE="/var/log/wazuh/active-response/containment.log"

# File output untuk eradication
ERADICATION_LOG_FILE="/var/log/wazuh/active-response/eradication.log"

# File output untuk restore
RESTORE_LOG_FILE="/var/log/wazuh/active-response/restore.log"
RESTORE_AUTO_LOG_FILE="/var/log/wazuh/active-response/restore_auto.log"

# =================================================================
# SYSTEM INTEGRATION - Integrasi dengan Sistem
# =================================================================

# Timeout untuk operasi (dalam detik)
COMMAND_TIMEOUT="300"
RESTORE_TIMEOUT="600"

# Retry attempts untuk operasi yang gagal
MAX_RETRY_ATTEMPTS="3"

# Interval retry (dalam detik)
RETRY_INTERVAL="30"

# =================================================================
# SECURITY SETTINGS - Pengaturan Keamanan
# =================================================================

# Mode debug (true/false)
DEBUG_MODE="false"

# Log level (DEBUG, INFO, WARNING, ERROR)
LOG_LEVEL="INFO"

# Enkripsi backup (true/false)
ENCRYPT_BACKUP="false"

# Backup retention days
BACKUP_RETENTION_DAYS="30" 

# =================================================================
# INTEGRATION VALIDATION - Validasi Integrasi Sistem
# =================================================================

# Path script Python yang terintegrasi
PYTHON_SCRIPTS_DIR="/usr/local/bin"
SOC_MAIN_SCRIPT="soc_incident_response.py"
DETECTION_SCRIPT="Deteksi.py"
CONTAINMENT_SCRIPT="containment.py"
ERADICATION_SCRIPT="eradication.py"
RESTORE_SCRIPT="restore.py"
POSTIA_SCRIPT="PostIA.py"

# Validasi integrasi otomatis
AUTO_VALIDATE_INTEGRATION="true"
INTEGRATION_CHECK_INTERVAL="3600"

# Health check endpoints
HEALTH_CHECK_ENDPOINTS="http://localhost:1514,http://localhost:8080" 